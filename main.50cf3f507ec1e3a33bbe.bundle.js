(()=>{"use strict";var e={d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{BACKGROUND_IMAGE:()=>T,BIRD_SPRITE:()=>E,BUTTON_SPRITE:()=>A,GROUND:()=>z,PLAYER_SPRITE:()=>L,SPIKE_UP:()=>O});var s={};e.r(s),e.d(s,{JUMP_SOUND:()=>I});const i=class{},r=class{constructor(e,t){this.x=null!=e?e:0,this.y=null!=t?t:0}squaredistance(e){const t=this.x-e.x,s=this.y-e.y;return t*t+s*s}},n=class extends i{constructor(e,t){super(),this.flip=new r(1,1),this.rotation=0,this.position=null!=e?e:new r(0,0),this.scale=null!=t?t:new r(1,1)}};var o=function(e,t,s,i){return new(s||(s=Promise))((function(r,n){function o(e){try{l(i.next(e))}catch(e){n(e)}}function a(e){try{l(i.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};class a{static initialize(){}static loadImages(e){return o(this,void 0,void 0,(function*(){a.deploy?a.KEY="https://beastkr.github.io/dont-touch-spike-engine":a.KEY="..";const t=e=>new Promise(((t,s)=>{const i=new Image;i.onload=()=>t(i),i.onerror=s,i.src=a.KEY+"/assets/images/"+e}));for(const s of e)try{const e=yield t(s),i="/assets/images/"+s;a.imagelist[i]=e}catch(e){console.error(`Failed to load image: ${s}`,e)}}))}static loadSounds(e){return o(this,void 0,void 0,(function*(){a.deploy?a.KEY="https://beastkr.github.io/dont-touch-spike-engine":a.KEY="..";const t=e=>new Promise(((t,s)=>{const i=new Audio(a.KEY+"/assets/sfx/"+e);i.preload="auto",i.oncanplaythrough=()=>t(i),i.onerror=()=>s(new Error(`Failed to load sound: ${e}`))}));for(const s of e)try{const e=yield t(s),i="/assets/sfx/"+s;a.soundList[i]=e}catch(e){console.error(`Failed to load sound: ${s}`,e)}}))}static addtolist(e){for(var t of e)a.imgpathlist.push(t)}}a.imagelist={},a.soundList={},a.imgpathlist=[],a.deploy=!0;const l=a,c=class extends i{constructor(e){if(super(),this.image=new Image,this.flipvector=new r(1,1),this.imgpath=null!=e?e:"",e&&""!=this.imgpath){const t=l.imagelist["/assets/images/"+e];this.image=t}this.color=[0,0,0,1]}rgb(){return`rgb(${this.color[0]}, ${this.color[1]}, ${this.color[2]})`}flipimage(e){this.flipvector=e}render(e,t,s,i){const r=document.querySelector("canvas");this.ctx=r.getContext("2d");let n=this.ctx;if(!n)return;const o=e.x-s.x,a=e.y-s.y;n.save(),n.translate(o,a),n.scale(this.flipvector.x,this.flipvector.y);const l=(this.flipvector.x,-t.x/2),c=(this.flipvector.y,-t.y/2);if(n.rotate(this.rotation*Math.PI/180),""===this.imgpath)n.beginPath(),n.globalAlpha=this.color[3],n.arc(0,0,t.x/2,0,2*Math.PI),n.fillStyle=this.rgb(),n.fill(),n.globalAlpha=1;else if(i){const[e,s,r,o]=i;n.drawImage(this.image,e,s,r,o,l,c,t.x,t.y)}else n.drawImage(this.image,l,c,t.x,t.y);n.restore()}rotate(e){this.rotation=e}},h=class{constructor(e,t,s){this.spriterenderer=new c,this.transform=new n(t,s);let i=new r(this.transform.position.x,this.transform.position.y),o=new r(this.transform.scale.x,this.transform.scale.y);this.originalTransform=new n(i,o)}render(e,t){if(this.spriterenderer){let e=this.transform.position,s=this.transform.scale;this.spriterenderer.rotate(this.transform.rotation),this.spriterenderer.render(e,s,t)}}update(e){}reset(){let e=new r(this.originalTransform.position.x,this.originalTransform.position.y),t=new r(this.originalTransform.scale.x,this.originalTransform.scale.y);this.transform=new n(e,t),this.spriterenderer.flipimage(this.transform.flip),this.transform.rotation=this.originalTransform.rotation}},p=class extends h{constructor(e,t,s,i){super(e,t,s),this.text=null!=i?i:[],this.spriterenderer.color=[0,0,0,0]}render(e,t){super.render(e,t);const s=this.spriterenderer.ctx;if(!s)return;let i=this.transform.position;s.font=this.text[1],s.fillStyle=this.text[2],s.textAlign="center",s.textBaseline="middle";let r=(null==t?void 0:t.x)||0,n=(null==t?void 0:t.y)||0;s.fillText(this.text[0],i.x-r,i.y-n)}update(e){}},d=new r(0,0),u=new r(400,550);class m{static reset(e){let t=m.sceneColliderList.get(e);m.listcollider=t||[]}static addcollider(e,t){var s;m.sceneColliderList.has(t)||m.sceneColliderList.set(t,[]),m.listcollider.push(e),null===(s=m.sceneColliderList.get(t))||void 0===s||s.push(e),m.size.set(t,(m.size.get(t)||0)+1)}static getAllColliders(e){return ne.sceneList.has(e)&&m.sceneColliderList.get(e)||[]}}m.sceneColliderList=new Map,m.listcollider=[],m.size=new Map;const f=m,g=class extends h{constructor(e,t){super(e,t),this.transform.scale=u}},w=class{constructor(e){this.originalPos=new Map,this.name=e||"default",this.gameObject=[],this.camera=new g(this.name,d),ae.canvas||ae.initialize(this.camera)}pushGameObject(e){this.gameObject.push(e);let t=new r(e.transform.position.x,e.transform.position.y),s=new r(e.transform.scale.x,e.transform.scale.y);e.originalTransform=new n(t,s),e.originalTransform.rotation=e.transform.rotation}reset(){for(const e of this.gameObject)e.reset()}update(e){for(var t of this.gameObject)t.update(e)}render(e){for(var t of(ae.flip(),this.gameObject))t.render(e,this.camera.transform.position);ne.pausing&&ae.pause()}},x=class{constructor(e){this.isTrigger=!1,this.id=f.size.get(e)||0,f.addcollider(this,e),this.layer="default"}collide(e){return[this,!1]}drawDebug(e){e&&!this.isTrigger&&(e.strokeStyle="red",e.strokeRect(this.position.x-this.scale.x/2,this.position.y-this.scale.y/2,this.scale.x,this.scale.y))}checkCollide(){return[]}};class y extends x{constructor(e,t,s){var i,n;super(e),this.sceneKey=e,t=null!=t?t:new r,s=null!=s?s:new r,this.position=null!==(i=new r(t.x,t.y))&&void 0!==i?i:new r,this.scale=null!==(n=new r(s.x,s.y))&&void 0!==n?n:new r(1,1)}collide(e){for(var t in f.getAllColliders(this.sceneKey)){let s=f.getAllColliders(this.sceneKey)[t];if(t!==String(this.id)&&s instanceof y&&s.layer==e){const e=s,t=this.position.x-this.scale.x/2,i=this.position.x+this.scale.x/2,r=this.position.y-this.scale.y/2,n=this.position.y+this.scale.y/2,o=e.position.x-e.scale.x/2,a=e.position.x+e.scale.x/2,l=e.position.y-e.scale.y/2,c=e.position.y+e.scale.y/2;if(t<a&&i>o&&r<c&&n>l)return[e,!0]}}return[this,!1]}checkCollide(){let e=[];for(var t in f.getAllColliders(this.sceneKey)){let s=f.getAllColliders(this.sceneKey)[t];if(t!==String(this.id)&&s instanceof y){const t=s,i=this.position.x-this.scale.x/2,r=this.position.x+this.scale.x/2,n=this.position.y-this.scale.y/2,o=this.position.y+this.scale.y/2,a=t.position.x-t.scale.x/2,l=t.position.x+t.scale.x/2,c=t.position.y-t.scale.y/2,h=t.position.y+t.scale.y/2;i<l&&r>a&&n<h&&o>c&&e.push(t)}}return e}}const v=y;class b{static initialize(){const e=document.querySelector("canvas");window.addEventListener("keydown",(e=>{ne.pausing&&ne.resumable&&ne.resume(),b.key=e.key})),window.addEventListener("keyup",(e=>{b.key=""})),e.addEventListener("mousemove",(t=>{const s=e.getBoundingClientRect(),i=t.clientX-s.left,r=t.clientY-s.top;b.mousepos[0]=i/ae.ratioX,b.mousepos[1]=r/ae.ratioY,b.mousepos[2]=0,b.mousepos[3]=0})),e.addEventListener("click",(t=>{ne.pausing&&ne.resumable&&ne.resume();const s=e.getBoundingClientRect(),i=t.clientX-s.left,r=t.clientY-s.top;b.mousepos[0]=i/ae.ratioX,b.mousepos[1]=r/ae.ratioY,b.mousepos[2]=i/ae.ratioX,b.mousepos[3]=r/ae.ratioY})),e.addEventListener("mouseup",(()=>{b.mousepos[2]=0,b.mousepos[3]=0})),document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState?ne.pause():ne.resumable=!0})),window.addEventListener("resize",(()=>{ae.resizeCanvas(),b.initialize()})),window.addEventListener("blur",(()=>{ne.pause()})),window.addEventListener("focus",(()=>{ne.resumable=!0}))}static reset(){b.mousepos=[0,0,0,0]}}b.key="",b.keyboard=!0,b.mousepos=[0,0,0,0];const S=b,k=class extends h{constructor(e,t,s){super(e,t,s),this.layer="default",this.collider=new v(e,t,s)}update(e){this.collider.position.x=this.transform.position.x,this.collider.position.y=this.transform.position.y,super.update(e)}render(e,t){super.render(e,t)}},j=class extends k{constructor(e,t,s){super(e,t,s),this.spriterenderer=new c("button.png"),this.onclickcallbacks=[],this.text=new p(e,t,s),this.text.text=["Button","20px Arieal","red"],this.collider=t&&s?new v(e,t,s):new v(e),this.collider.layer="button"}update(e){super.update(e),this.hovered=this.collider.collide("cursor")[1],this.hovered&&this.onhover(),S.mousepos&&this.hovered&&0!=S.mousepos[2]&&0!=S.mousepos[3]&&(S.mousepos[2]=0,S.mousepos[3]=0,this.onclicked())}render(e,t){super.render(e,t),this.spriterenderer.ctx&&(this.transform.position,this.text.render(e,t))}onclicked(){console.log("clicked");for(const e of this.onclickcallbacks)e()}addonclick(e){this.onclickcallbacks.push(e)}setText(e){this.text.text[0]=e}onhover(){}},C=class extends k{constructor(e,t,s){super(e,t,s),this.clicking=!1,S.reset(),this.collider=t&&s?new v(e,t,s):new v(e),this.collider.layer="cursor",this.spriterenderer=new c,this.spriterenderer.color=[0,0,0,0]}update(e){super.update(e),this.clicking=0==S.mousepos[3],this.transform.position.x=S.mousepos[0],this.transform.position.y=S.mousepos[1]}render(e,t){super.render(e,t)}reset(){this.transform.position=new r}},T="bg.png",L="MouseSpritesheet.png",A="button.png",O="spikeup.png",z="groundup.png",E="bird.png";class G{static initialize(){G.highscore=Number(localStorage.getItem("highscore")),G.highScoreText.text[0]=String(G.highscore)}static reset(){G.score=0,G.text.text[0]="0"}static increase(){G.score++,G.score>G.highscore&&(G.highscore=G.score,localStorage.setItem("highscore",String(G.highscore)),G.highScoreText.text[0]=String(G.highscore),console.log(localStorage)),G.text.text[0]=String(G.score)}}G.score=0,G.highscore=0;const R=G,P=class extends w{constructor(){super("menu");let e=new h(this.name,new r(200,350),new r(400,700));e.spriterenderer=new c(T),this.pushGameObject(e);let t=["DON'T TOUCH\nTHE SPIKE","30px Times New Roman","white"],s=new p(this.name,new r(200,100),new r,t);this.pushGameObject(s),t=[String(R.score),"100px Arieal","white"];let i=new p(this.name,new r(200,200),new r(200,100),t);R.highScoreText=i,this.pushGameObject(i);let n=new j(this.name,new r(200,400),new r(200,100));n.setText("Start Game"),n.text.text[1]="40px Times New Roman",n.text.text[2]="white",n.addonclick((()=>{ne.setActive("game")})),this.pushGameObject(n),this.pushGameObject(new C(this.name,new r(0,0),new r(20,20)))}update(e){super.update(e)}render(e){super.render(e)}},I="jump.mp3";class M{static initialize(){M.channel=new Map}static play(e){var t;null===(t=M.channel.get(e))||void 0===t||t.play()}static addAudioChannel(e){M.channel.set(e.name,e)}}const F=M;class K{static initialize(){K.tileSet=new Map}static addToTileSet(e){K.tileSet.set(K.size,e),K.size++}static getTile(e){return K.tileSet.get(e)||""}}K.size=0;const Y=K,N=class extends w{constructor(){super("loading"),this.resources=Object.values(t),l.addtolist(this.resources),l.loadImages(this.resources).then((()=>{Y.initialize(),Y.addToTileSet(A),this.resources=Object.values(s),l.loadSounds(this.resources).then((()=>{F.initialize(),ne.initScene(),ne.setActive("menu"),R.initialize()})).catch((e=>{console.error("Error loading resources:",e)}))})).catch((e=>{console.error("Error loading resources:",e)}))}},$=class extends k{constructor(e,t,s){super(e,t,s),this.collider.layer="player"}update(e){super.update(e)}render(e,t){super.render(e,t),this.animator&&this.spriterenderer.render(this.transform.position,this.transform.scale,t,this.animator.getCurrentFrameRect())}},_=class{constructor(e){this.power=null!=e?e:new r(0,0)}},q=class extends _{constructor(){super(),this.power=new r(0,300)}};class B{static initialize(){B.gravity=new q}static addforce(e,t,s){e.x=e.x+t.power.x*s,e.y=e.y+t.power.y*s}}const D=B,H=class extends i{constructor(e){super(),this.fps=4,this.currentindex=0,this.safeprogress=0,this.starttime=0,this.spritesheet=!1,this.frameWidth=0,this.frameHeight=0,this.numFrames=0,this.animation=[],this.sprite=e,this.interval=1e3/this.fps}loadAnim(e,t,s,i){this.spritesheet=e,e&&"string"==typeof t&&s&&i?(this.sprite.image=l.imagelist["/assets/images/"+t],this.frameWidth=s,this.frameHeight=i,this.numFrames=Math.floor(this.sprite.image.width/s)):!e&&Array.isArray(t)&&(this.animation=t.map((e=>"../../assets/images/"+e)))}play(e){if(0===this.fps)return;0===this.starttime&&(this.starttime=performance.now());let t=Math.floor(performance.now()%1e3/this.interval);t!==this.safeprogress&&(this.safeprogress=t,this.currentindex=(this.currentindex+1)%(this.spritesheet?this.numFrames:this.animation.length),this.spritesheet||(this.sprite.image.src=this.animation[this.currentindex]))}getCurrentFrameRect(){if(this.spritesheet)return[this.currentindex*this.frameWidth,0,this.frameWidth,this.frameHeight]}stop(){this.fps=0}continue(){this.fps=4}},U=class extends ${constructor(e,t,s){super(e,t,s),this.jumpCounter=0,this.jumpable=!0,this.jumping=!1,this.touchCeiling=!1,this.jumpForce=new _(new r(0,-800)),this.speed=new _(new r(200,0)),this.facingLeft=!1,this.bouncing=!1,this.onground=!1,this.spriterenderer=new c(L),this.animator=new H(this.spriterenderer),this.animator.loadAnim(!0,L,16,16),this.collider.scale.x=this.transform.scale.x/2,this.collider.scale.y=this.transform.scale.y/2}update(e){if(super.update(e),this.transform.rotation=0,D.addforce(this.transform.position,this.speed,e),this.onground){let e=this.collider.collide("ground")[0];this.transform.position.y=e.position.y-this.transform.scale.y/2-e.scale.y/2+1}else D.addforce(this.transform.position,D.gravity,e);if(this.statReset(),this.collider.checkCollide()){let e=this.collider.checkCollide();for(var t of e)"ground"==t.layer&&(this.onground=!0),"ceiling"==t.layer&&(this.touchCeiling=!0)}this.collider.collide("wall")[1]&&!this.bouncing?(F.play("jump"),R.increase(),this.spikeLeft.expose(),this.spikeright.expose(),this.facingLeft=!this.facingLeft,this.bouncing=!0,this.speed.power.x=-this.speed.power.x,this.transform.flip.x=-this.transform.flip.x,this.spriterenderer.flipimage(this.transform.flip)):this.collider.collide("wall")[1]||(this.bouncing=!1),this.jumpable||(this.jumpCounter+=e),this.jumpCounter>=.15&&(this.jumping=!1,""==S.key&&(this.jumpable=!0,this.jumpCounter=0)),this.jumping&&!this.touchCeiling&&(D.addforce(this.transform.position,this.jumpForce,e),this.transform.rotation=-45),this.animator.play(e)," "!=S.key&&0==S.mousepos[2]||!this.jumpable||(this.jumpable=!1,this.jumping=!0,this.jumpCounter=0,S.mousepos[2]=0),this.collider.collide("spike")[1]&&this.gameover()}render(e,t){super.render(e,t)}statReset(){this.onground=!1,this.touchCeiling=!1}reset(){super.reset(),this.onground=!1,this.touchCeiling=!1,this.bouncing=!1,this.facingLeft=!1,this.jumpable=!0,this.jumping=!1,this.transform.flip.x=1,this.jumpCounter=0,this.speed.power.x=200}gameover(){ne.setActive("menu")}},W=class extends k{constructor(e,t,s){super(e,t,s),this.collider.layer="spike",this.spriterenderer=new c(O),this.collider.scale.y=this.transform.scale.y/2}update(e){super.update(e)}render(e,t){super.render(e,t)}};function X(e,t){return Math.floor(Math.random()*(t-e))+e}const J=class extends h{constructor(e,t,s,i){super(e),this.isLeft=!1,90==s&&(this.isLeft=!0),this.marginPos=i,this.spikelist=[];for(let i=0;i<t;i++){let t=new W(e,new r(-100,-100),new r(50,50));t.transform.rotation=s,this.spikelist.push(t)}}hide(){for(let e of this.spikelist)this.player.facingLeft==this.isLeft&&(e.transform.position=new r(-100,-100))}expose(){const e=this.isLeft?15:-15;if(this.player.facingLeft!==this.isLeft)for(const t of this.spikelist){let s;s=this.getRandom(50,500),t.transform.position=new r(this.marginPos+e,s)}else this.hide()}update(e){for(let t of this.spikelist)t.update(e)}render(e,t){for(let s of this.spikelist)s.render(e,t),document.querySelector("canvas").getContext("2d")}setplayer(e){this.player=e}reset(){for(let e of this.spikelist)e.transform.position=new r(-100,-100)}getRandom(e,t){return X(e,t)}},Q=class extends h{constructor(e,t,s){super(e),this.name=s,this.AudioSource=l.soundList["/assets/sfx/"+t],F.addAudioChannel(this)}play(){this.AudioSource&&this.AudioSource.cloneNode().play()}stop(){this.AudioSource&&this.AudioSource.pause()}},V=class extends k{constructor(e,t,s,i){super(e,s,i),this.id=t,this.spriterenderer=new c(A)}},Z=class extends V{constructor(e,t,s,i){super(e,t,s,i),this.id=t,this.spriterenderer.color=[0,0,0,0],this.spike=new W(e,s,i),this.spike.collider.scale.x=this.transform.scale.x/2,this.spike.collider.scale.y=this.transform.scale.y}render(e,t){this.spike.render(e,t)}update(e){this.spike.transform.rotation=this.transform.rotation,this.spike.update(e)}},ee=class extends h{constructor(e,t,s,i,r){super(e,i,r),this.size=s,this.loadTile(e,t)}render(e,t){for(var s of this.map)for(var i of s)i.render(e,t)}reset(){for(var e of(super.reset(),this.map))for(var t of e)t.reset()}update(e){for(var t of this.map)for(var s of t)s.transform.rotation=this.transform.rotation,s.update(e)}loadTile(e,t){this.map=[];for(let s=0;s<t.length;s++){this.map[s]=[];for(let i=0;i<t[s].length;i++){let n=(i+.5)*this.size.x+this.transform.position.x,o=(s+.5)*this.size.y+this.transform.position.y,a=new r(n,o);const l=new Z(e,t[s][i],a,this.size);this.map[s].push(l)}}}},te=class extends h{render(e,t){let s=this.transform.position,i=this.transform.scale;this.spriterenderer.render(s,i,t,this.animator.getCurrentFrameRect())}},se=class extends te{constructor(e,t,s,i){super(e,s,i),this.speed=t,this.spriterenderer=new c(E),this.animator=new H(this.spriterenderer),this.animator.loadAnim(!0,E,16,16),this.reset()}update(e){super.update(e),this.animator.play(e),D.addforce(this.transform.position,new _(new r(this.speed,0)),e),(this.transform.position.x>u.x+100||this.transform.position.x<-100)&&(this.speed=-this.speed,this.transform.flip.x=-this.transform.flip.x,this.spriterenderer.flipimage(this.transform.flip))}reset(){this.transform.position.y=X(d.y+100,u.y-100),this.transform.position.x=X(d.x,u.x)}},ie=class extends w{constructor(){super("game");let e=new Q(this.name,I,"jump");this.pushGameObject(e);let t=new h(this.name,new r(200,350),new r(400,700));t.spriterenderer=new c(T),this.pushGameObject(t);for(let e=0;e<3;e++)this.pushGameObject(new se(this.name,50,new r(300,300),new r(50,50)));for(let e=0;e<3;e++)this.pushGameObject(new se(this.name,100,new r(100,100),new r(100,100)));let s=new ee(this.name,[[0,0,0,0,0,0,0,0,0]],new r(50,50),new r(0,500));this.pushGameObject(s);let i=new ee(this.name,[[0,0,0,0,0,0,0,0,0]],new r(50,50),new r(0,0));i.transform.rotation=180,this.pushGameObject(i);let n=[String(R.score),"100px Arieal","white"],o=new p(this.name,new r(200,200),new r(200,100),n);R.text=o,this.pushGameObject(o);let a=new k(this.name,new r(0,350),new r(5,700));a.spriterenderer=new c(L),a.collider.layer="wall",this.pushGameObject(a),a=new k(this.name,new r(400,350),new r(5,700)),a.spriterenderer=new c(L),a.collider.layer="wall",this.pushGameObject(a);let l=new U(this.name,new r(200,200),new r(30,30)),d=new J(this.name,6,90,0),u=new J(this.name,6,270,400);l.spikeLeft=d,l.spikeright=u,u.setplayer(l),d.setplayer(l),this.pushGameObject(d),this.pushGameObject(u),this.pushGameObject(l)}reset(){super.reset(),R.reset()}};class re{static initialize(){re.sceneList=new Map,re.sceneList.set("loading",new N),re.setActive("loading")}static initScene(){re.sceneList.set("menu",new P),re.sceneList.set("game",new ie)}static update(e){var t;null===(t=re.sceneList.get(re.activeScene))||void 0===t||t.update(e)}static render(e){var t;null===(t=re.sceneList.get(re.activeScene))||void 0===t||t.render(e)}static setActive(e){var t;if(S.reset(),re.sceneList.has(e)){f.reset(e),re.getCurrentScene().reset(),re.activeScene=e;let s=null===(t=re.sceneList.get(e))||void 0===t?void 0:t.camera;s&&ae.initialize(s)}}static getCurrentScene(){return re.sceneList.get(re.activeScene)||new w}static pause(){console.log("pausing"),re.pausing=!0,re.resumable=!1}static resume(){console.log("resume"),re.pausing=!1}}re.pausing=!1,re.resumable=!1;const ne=re;class oe{static initialize(e){oe.camera=e,oe.canvas||(oe.canvas=document.createElement("canvas")),oe.canvas.getContext("2d"),oe.canvas.height=e.transform.scale.y,oe.canvas.width=e.transform.scale.x,oe.canvas.style.position="absolute",oe.canvas.style.top="50%",oe.canvas.style.left="50%",oe.canvas.style.transform="translate(-50%, -50%)",document.body.appendChild(oe.canvas),oe.resizeCanvas()}static flip(){const e=document.querySelector("canvas").getContext("2d");e&&(e.imageSmoothingEnabled=!1,e.fillStyle="white",e.fillRect(0,0,oe.camera.transform.scale.x,oe.camera.transform.scale.y))}static getCanvas(){return oe.canvas}static resizeCanvas(){const e=window.innerWidth/window.innerHeight,t=u.x/u.y;let s,i;e>t?(i=window.innerHeight,s=i*t):(s=window.innerWidth,i=s/t),oe.canvas.style.width=`${s}px`,oe.canvas.style.height=`${i}px`,oe.ratioX=s/u.x,oe.ratioY=i/u.y,oe.canvas.style.imageRendering="pixelated"}static pause(){const e=document.querySelector("canvas").getContext("2d");e&&(e.globalAlpha=.9,e.imageSmoothingEnabled=!1,e.fillStyle="black",e.fillRect(0,0,oe.camera.transform.scale.x,oe.camera.transform.scale.y),e.globalAlpha=1),new p("",new r(200,250),new r,["Click to continue","30px Ariel","white"]).render(0,ne.getCurrentScene().camera.transform.position)}}const ae=oe;class le{static initialize(){le.prevTime=0,le.currentTime=performance.now()/1e3}static startFrame(){le.currentTime=performance.now()/1e3,le.delta()}static endFrame(){le.prevTime=le.currentTime}static delta(){le.deltaTime=le.currentTime-le.prevTime}}const ce=le;document.title="Don't Touch The Spike",(new class{constructor(){ne.initialize(),D.initialize()}loop(){ce.startFrame(),ne.pausing&&(ce.deltaTime=0),this.update(ce.deltaTime),this.render(ce.deltaTime),ce.endFrame(),requestAnimationFrame(this.loop.bind(this))}update(e){ne.update(e)}render(e){ne.render(e)}start(){var e;ce.initialize();let t=null===(e=ne.sceneList.get(ne.activeScene))||void 0===e?void 0:e.camera;t&&ae.initialize(t),S.initialize(),this.loop()}}).start()})();